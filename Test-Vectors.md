# Test Vectors for PKD Specification

Spec: <https://github.com/fedi-e2ee/public-key-directory-specification>

These vectors are generated by `vectorgen/generate.php` and are deterministic (except for HPKE
encryption, which uses a placeholder for reproducibility).

## Seed Derivation

All test vectors use deterministic key derivation from seed strings. The derivation uses
HMAC-SHA512 with domain separation via PAE (Pre-Authentication Encoding):

```text
seed_bytes = HMAC-SHA512(key: "pkd-vectorgen-v1", message: PAE(type, seed_string))
```

Where PAE is defined as (per PASETO):

```text
PAE(pieces) = LE64(len(pieces)) || LE64(len(pieces[0])) || pieces[0] || ... || LE64(len(pieces[n])) || pieces[n]
```

### Ed25519 Key Derivation

```text
seed = HMAC-SHA512("pkd-vectorgen-v1", PAE("ed25519", test_case_id))
secret_key = seed[0:32]  // First 32 bytes as seed
public_key = Ed25519.PublicKeyFromSeed(secret_key)
```

### X25519 Key Derivation

```text
seed = HMAC-SHA512("pkd-vectorgen-v1", PAE("x25519", test_case_id))
secret_key = seed[0:32] with clamping
public_key = X25519.ScalarMultBase(secret_key)
```

### Symmetric Key Derivation

```text
raw = HMAC-SHA512("pkd-vectorgen-v1", PAE("symmetric-key", key_id))
key = HKDF-Expand(SHA512, raw[0:32], purpose, 32)
```
